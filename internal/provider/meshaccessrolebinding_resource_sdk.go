// Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

package provider

import (
	"context"
	"github.com/hashicorp/terraform-plugin-framework/diag"
	"github.com/hashicorp/terraform-plugin-framework/types"
	tfTypes "github.com/kong/terraform-provider-kong-mesh/internal/provider/types"
	"github.com/kong/terraform-provider-kong-mesh/internal/sdk/models/operations"
	"github.com/kong/terraform-provider-kong-mesh/internal/sdk/models/shared"
)

func (r *MeshAccessRoleBindingResourceModel) RefreshFromSharedAccessRoleBindingCreateOrUpdateSuccessResponse(ctx context.Context, resp *shared.AccessRoleBindingCreateOrUpdateSuccessResponse) diag.Diagnostics {
	var diags diag.Diagnostics

	if resp != nil {
		r.Warnings = make([]types.String, 0, len(resp.Warnings))
		for _, v := range resp.Warnings {
			r.Warnings = append(r.Warnings, types.StringValue(v))
		}
	}

	return diags
}

func (r *MeshAccessRoleBindingResourceModel) RefreshFromSharedAccessRoleBindingItem(ctx context.Context, resp *shared.AccessRoleBindingItem) diag.Diagnostics {
	var diags diag.Diagnostics

	if resp != nil {
		if len(resp.Labels) > 0 {
			r.Labels = make(map[string]types.String, len(resp.Labels))
			for key, value := range resp.Labels {
				r.Labels[key] = types.StringValue(value)
			}
		}
		r.Name = types.StringValue(resp.Name)
		if resp.Roles != nil {
			r.Roles = make([]types.String, 0, len(resp.Roles))
			for _, v := range resp.Roles {
				r.Roles = append(r.Roles, types.StringValue(v))
			}
		}
		if resp.Subjects != nil {
			r.Subjects = []tfTypes.Subjects{}

			for _, subjectsItem := range resp.Subjects {
				var subjects tfTypes.Subjects

				subjects.Name = types.StringPointerValue(subjectsItem.Name)
				subjects.Type = types.StringPointerValue(subjectsItem.Type)

				r.Subjects = append(r.Subjects, subjects)
			}
		}
		r.Type = types.StringValue(resp.Type)
	}

	return diags
}

func (r *MeshAccessRoleBindingResourceModel) ToOperationsDeleteAccessRoleBindingRequest(ctx context.Context) (*operations.DeleteAccessRoleBindingRequest, diag.Diagnostics) {
	var diags diag.Diagnostics

	var name string
	name = r.Name.ValueString()

	out := operations.DeleteAccessRoleBindingRequest{
		Name: name,
	}

	return &out, diags
}

func (r *MeshAccessRoleBindingResourceModel) ToOperationsGetAccessRoleBindingRequest(ctx context.Context) (*operations.GetAccessRoleBindingRequest, diag.Diagnostics) {
	var diags diag.Diagnostics

	var name string
	name = r.Name.ValueString()

	out := operations.GetAccessRoleBindingRequest{
		Name: name,
	}

	return &out, diags
}

func (r *MeshAccessRoleBindingResourceModel) ToOperationsPutAccessRoleBindingRequest(ctx context.Context) (*operations.PutAccessRoleBindingRequest, diag.Diagnostics) {
	var diags diag.Diagnostics

	var name string
	name = r.Name.ValueString()

	accessRoleBindingItem, accessRoleBindingItemDiags := r.ToSharedAccessRoleBindingItem(ctx)
	diags.Append(accessRoleBindingItemDiags...)

	if diags.HasError() {
		return nil, diags
	}

	out := operations.PutAccessRoleBindingRequest{
		Name:                  name,
		AccessRoleBindingItem: *accessRoleBindingItem,
	}

	return &out, diags
}

func (r *MeshAccessRoleBindingResourceModel) ToSharedAccessRoleBindingItem(ctx context.Context) (*shared.AccessRoleBindingItem, diag.Diagnostics) {
	var diags diag.Diagnostics

	labels := make(map[string]string)
	for labelsKey, labelsValue := range r.Labels {
		var labelsInst string
		labelsInst = labelsValue.ValueString()

		labels[labelsKey] = labelsInst
	}
	var name string
	name = r.Name.ValueString()

	var roles []string
	if r.Roles != nil {
		roles = make([]string, 0, len(r.Roles))
		for _, rolesItem := range r.Roles {
			roles = append(roles, rolesItem.ValueString())
		}
	}
	var subjects []shared.Subjects
	if r.Subjects != nil {
		subjects = make([]shared.Subjects, 0, len(r.Subjects))
		for _, subjectsItem := range r.Subjects {
			name1 := new(string)
			if !subjectsItem.Name.IsUnknown() && !subjectsItem.Name.IsNull() {
				*name1 = subjectsItem.Name.ValueString()
			} else {
				name1 = nil
			}
			typeVar := new(string)
			if !subjectsItem.Type.IsUnknown() && !subjectsItem.Type.IsNull() {
				*typeVar = subjectsItem.Type.ValueString()
			} else {
				typeVar = nil
			}
			subjects = append(subjects, shared.Subjects{
				Name: name1,
				Type: typeVar,
			})
		}
	}
	var typeVar1 string
	typeVar1 = r.Type.ValueString()

	out := shared.AccessRoleBindingItem{
		Labels:   labels,
		Name:     name,
		Roles:    roles,
		Subjects: subjects,
		Type:     typeVar1,
	}

	return &out, diags
}
